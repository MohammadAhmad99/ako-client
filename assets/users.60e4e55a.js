import{u as w,c as W,h as X,O,Q as Y,T as Z,V as g,W as A,X as J,Y as ee,g as ue,Z as re,o as se,_ as ne,$ as te,L as ae,a0 as oe,f as le,a1 as ie,P as T}from"./index-f9d5eff4.js";import{r as C,as as ce,ap as de,aj as he,aG as me,ah as ge,aq as pe,ar as fe}from"./@chakra-ui/icons.2b06a178.js";import{L as B}from"./LoadingList.f7d10c6d.js";import{u as Ae,j as e,d as u,e as p,ag as $,g as Ce,h as xe,l as I,b as j,t as z,K as De,L as be,N as ve,O as Se,T as U,Q as Ee,D as Ie,R as Ue,S as N,F as v,f as S,z as E,U as we,B as _,m as x,ad as Fe,ai as ye,k as H}from"./@chakra-ui/react.8bdcb90e.js";import"./framer-motion.81a66f27.js";const Re=()=>{const{userStore:s}=w(),l=Ae(),a=W(),t=async(h,o)=>{try{const n=await s.createUser(h,o);return l({title:"User created.",status:"info"}),n.data}catch(n){if(n.response)switch(n.response.status){case 422:l({title:`${n.response.data.errors[0].message}`,status:"error"});break;default:l({title:`${n.message}`,status:"error"});break}else a(n);return Promise.reject(n)}},{execute:i,...d}=X(t);return{createUser:i,...d}},Me=({isOpen:s,onClose:l,user:a})=>{const{userStore:t}=w(),{searchingRole:i,searchingPage:d,search:h}=C.exports.useContext(O),{deleteUser:o,isLoading:n}=Y(),{pagination:f}=t,D=async(r,b)=>{if(r)try{await o(b,{page:d,limit:f==null?void 0:f.per_page,role:i,search:h})}catch(F){console.error(F)}l()};return e(Z,{isOpen:s,isLoading:n,onClose:r=>D(r,a.id),title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641",message:`"${a.fullname}" \u0633\u064A\u062A\u0645 \u062D\u0630\u0641\u0647 \u0645\u0646 \u0627\u0644\u0646\u0638\u0627\u0645 \u062A\u0645\u0627\u0645\u0627\u064B.`,confirmMessage:"\u062D\u0630\u0641"})},_e=()=>{const{searchingRole:s,setSearchingRole:l,setSearchingPage:a,search:t,setSearch:i}=C.exports.useContext(O),d=o=>{a(1),l(o.target.value)},h=o=>{a(1),i(o.target.value)};return u(p,{flexBasis:"600px",children:[u($,{value:s,onChange:d,size:"sm",w:"full",mr:"2",children:[e("option",{value:"any",children:"\u0623\u064A \u0635\u0644\u0627\u062D\u064A\u0629"}),e("option",{value:g.ADMIN,children:"\u0645\u062F\u064A\u0631"}),e("option",{value:g.TEACHER,children:"\u0645\u062F\u0631\u0633"}),e("option",{value:g.STUDENT,children:"\u0637\u0627\u0644\u0628"})]}),u(Ce,{maxW:"400px",w:"full",size:"sm",children:[e(xe,{pointerEvents:"none",children:e(ce,{color:"gray.300"})}),e(I,{placeholder:"\u0627\u0628\u062D\u062B \u0639\u0646 \u0645\u0633\u062A\u062E\u062F\u0645...",value:t||"",onChange:h})]})]})},Oe=A.object().shape({first_name:A.string().required("\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0627\u0648\u0644 \u0645\u0637\u0644\u0648\u0628"),last_name:A.string().required("\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0627\u062E\u064A\u0631 \u0645\u0637\u0644\u0648\u0628"),login:A.string().required("\u0627\u0644\u0631\u0642\u0645 \u0645\u0637\u0644\u0648\u0628"),email:A.string().email("Email is invalid").required("Email field is required"),role:A.mixed().required("\u0644\u0627 \u064A\u0645\u0643\u0646 \u062A\u0631\u0643 \u0627\u0644\u0635\u0644\u0627\u062D\u064A\u0629 \u0641\u0627\u0631\u063A\u0629").oneOf(Object.values(g),`Available roles: ${Object.keys(g).join(", ")}`),password:A.string().required("Password field is required").min(6,"\u064A\u062C\u0628 \u0627\u0644\u0627 \u062A\u0642\u0644 \u0639\u0646 6 \u0645\u062D\u0627\u0631\u0641.")}),Le=()=>{const{userStore:s}=w(),{searchingRole:l,search:a}=C.exports.useContext(O),{createUser:t,isLoading:i}=Re(),{isOpen:d,onOpen:h,onClose:o}=j(),{register:n,handleSubmit:f,reset:D,formState:{errors:r}}=J({resolver:ee(Oe)}),{me:b}=s;return b===null?null:u(z,{children:[e(ue,{onClick:h}),u(De,{isOpen:d,onClose:o,children:[e(be,{}),e(ve,{children:u("form",{onSubmit:f(async L=>{var y,R;try{await t(L,{page:(y=s.pagination)==null?void 0:y.current_page,limit:(R=s.pagination)==null?void 0:R.per_page,role:l,search:a}),D(),o()}catch(k){console.error(k)}}),children:[e(Se,{children:u(p,{alignItems:"center",children:[e(re,{}),e(U,{ml:2,children:"\u0625\u0646\u0634\u0627\u0621 \u062D\u0633\u0627\u0628 \u062C\u062F\u064A\u062F"})]})}),e(Ee,{}),e(Ie,{}),e(Ue,{pb:6,children:u(N,{spacing:"4",children:[u(v,{isRequired:!0,children:[e(S,{children:"\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0623\u0648\u0644"}),e(I,{placeholder:"First name",...n("first_name"),isInvalid:!!r.first_name}),r.first_name&&e(E,{color:"red.500",children:r.first_name.message})]}),u(v,{isRequired:!0,children:[e(S,{children:"\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0623\u062E\u064A\u0631"}),e(I,{placeholder:"Last name",...n("last_name"),isInvalid:!!r.last_name}),r.last_name&&e(E,{color:"red.500",children:r.last_name.message})]}),u(v,{isRequired:!0,children:[e(S,{children:"\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641"}),e(I,{placeholder:"e.g student001",...n("login"),isInvalid:!!r.login}),r.login&&e(E,{color:"red.500",children:r.login.message})]}),u(v,{isRequired:!0,children:[e(S,{children:"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0643\u062A\u0631\u0648\u0646\u064A"}),e(I,{placeholder:"example@email.com",...n("email"),isInvalid:!!r.email}),r.email&&e(E,{color:"red.500",children:r.email.message})]}),u(v,{isRequired:!0,children:[e(S,{children:"\u0627\u0644\u0635\u0644\u0627\u062D\u064A\u0629"}),u($,{w:"full",mr:"2",...n("role"),isInvalid:!!r.role,children:[e("option",{value:g.STUDENT,children:"\u0637\u0627\u0644\u0628"}),b.isAdmin&&u(z,{children:[e("option",{value:g.TEACHER,children:"\u0645\u062F\u0631\u0633"}),e("option",{value:g.ADMIN,children:"\u0623\u062F\u0645\u0646"})]})]}),r.role&&e(E,{color:"red.500",children:r.role.message})]}),u(v,{isRequired:!0,children:[e(S,{children:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"}),e(I,{placeholder:"******",...n("password"),isInvalid:!!r.password}),e(E,{color:r.password?"red":"gray.500",children:r.password?r.password.message:"\u064A\u062C\u0628 \u0627\u0644\u0627 \u062A\u0642\u0644 \u0639\u0646 6 \u0645\u062D\u0627\u0631\u0641."})]})]})}),u(we,{children:[e(_,{type:"submit",variant:"outline",mr:3,colorScheme:"blue",isLoading:i,loadingText:"\u0625\u0646\u0634\u0627\u0621...",leftIcon:e(de,{}),children:"\u0625\u0646\u0634\u0627\u0621"}),e(_,{onClick:o,children:"\u0625\u0627\u0644\u063A\u0627\u0621"})]})]})})]})]})},ke=({render:s,limit:l})=>{const{userStore:a}=w(),{searchingRole:t,search:i,searchingPage:d,setSearchingPage:h}=C.exports.useContext(O),o=W(),[n,f]=C.exports.useState(null),[D,r]=C.exports.useState(null),{onOpen:b,onClose:F,isOpen:L}=j(),{onOpen:y,onClose:R,isOpen:k}=j(),{users:q,pagination:m,me:G,isLoading:Q}=a,V=c=>{r(c),b()},K=c=>{f(c),y()};if(C.exports.useEffect(()=>{a.loadUsersData({page:d,limit:l||(m==null?void 0:m.per_page),search:i,role:t}).catch(c=>o(c))},[o,a,i,t,d]),m===void 0||q===null||G===null)return e(B,{});const P=Math.ceil(m.total/m.per_page);return u(x,{children:[D&&e(ne,{user:D,isOpen:L,onClose:F}),n&&e(Me,{user:n,isOpen:k,onClose:R}),u(p,{justifyContent:"space-between",sx:{gap:"10px"},flexWrap:"wrap",children:[e(_e,{}),e(Le,{})]}),u(x,{children:[u(p,{mt:"5",p:"0 10px",fontWeight:"bold",alignItems:"center",justifyContent:"space-between",children:[u(U,{children:["\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A: (",m.total,")"]}),e(U,{children:"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"})]}),Q?e(B,{}):e(N,{mt:"4",spacing:"2",children:q.map(c=>e(s,{user:c,onEdit:M=>V(M),onDelete:M=>K({id:M.id,fullname:M.fullname})},c.id))})]}),q.length===0&&e(x,{textAlign:"center",userSelect:"none",children:e(U,{color:"gray.500",children:"\u0644\u0627 \u064A\u0645\u0643\u0646 \u0625\u064A\u062C\u0627\u062F \u0623\u064A \u0645\u0633\u062A\u062E\u062F\u0645."})}),u(p,{margin:"2rem 0",flexDirection:{base:"column",sm:"column",md:"row"},children:[e(x,{textAlign:{base:"center",sm:"center",md:"left"},mb:{base:"2",md:"0"},children:u(U,{fontSize:"sm",children:["\u0627\u0644\u0635\u0641\u062D\u0629 ",e("b",{children:m.current_page})," \u0645\u0646 ",P]})}),u(p,{ml:"auto",mr:"auto",justifyContent:"center",flexWrap:"wrap",alignItems:"center",sx:{gap:"30px"},children:[e(_,{onClick:()=>h(c=>c-1),disabled:m.current_page<=1,variant:"link",leftIcon:e(he,{}),children:"\u0627\u0644\u0635\u0641\u062D\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629"}),e(_,{onClick:()=>h(c=>c+1),disabled:m.current_page===P,variant:"link",rightIcon:e(me,{}),children:"\u0627\u0644\u0635\u0641\u062D\u0629 \u0627\u0644\u062A\u0627\u0644\u064A\u0629"})]})]})]})};var qe=se(ke);const Te=({user:s,onEdit:l,onDelete:a})=>{const{userStore:{me:t}}=w(),i=(()=>t!==null&&t.id===s.id?!0:te(s.roles,[g.ADMIN,g.TEACHER])&&t!==null?!!(t.isTeacher||t.isStudent):!1)();return e(x,{borderBottomWidth:"1px",borderRadius:"lg",w:"full",p:"3",bg:ge("gray.50","gray.700"),children:u(p,{flexDir:{base:"column",sm:"row"},alignItems:"center",sx:{gap:"20px"},children:[u(p,{alignItems:"center",flexDir:{base:"column",sm:"row"},flex:"1 1 0",children:[e(Fe,{name:s.fullname,size:"sm",ml:{base:"0",sm:"3"},mb:{base:"1",sm:"0"}}),u(x,{textAlign:{base:"center",sm:"right"},children:[e(ye,{as:ae,to:`/user/${s.id}`,fontSize:"md",fontWeight:"medium",children:s.fullname}),e(U,{fontSize:"sm",overflowWrap:"anywhere",children:s.email})]})]}),e(p,{sx:{gap:"5px"},justifyContent:"center",flex:"1 1 0",children:e(oe,{roles:s.roles})}),u(x,{children:[e(H,{size:"sm",disabled:i,onClick:()=>l(s),"aria-label":"\u062A\u0639\u062F\u064A\u0644",variant:"ghost",mr:1,icon:e(pe,{})}),e(H,{size:"sm",disabled:i,onClick:()=>a(s),colorScheme:"red","aria-label":"\u062D\u0630\u0641",variant:"ghost",icon:e(fe,{})})]})]})})},We=()=>{const{userStore:{me:s}}=w();return s===null?e(le,{}):e(ie,{children:u(T,{children:[e(T.Heading,{heading:"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645\u064A\u0646",description:"\u064A\u0645\u0643\u0646\u0643 \u0625\u0636\u0627\u0641\u0629 \u0623\u0648 \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645\u064A\u0646 \u0645\u0646 \u0647\u0646\u0627 ."}),u(T.Content,{mt:"5",children:[e("iframe",{src:"https://google.com",width:"200",height:"200"}),e(qe,{render:Te,limit:6})]})]})})};export{We as default};
